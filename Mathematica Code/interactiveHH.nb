(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     47407,       1103]
NotebookOptionsPosition[     46995,       1085]
NotebookOutlinePosition[     47343,       1100]
CellTagsIndexPosition[     47300,       1097]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"**", "**", "**", "**", "**", " ", "From"}], " ", "a", " ", 
     "notebook", " ", "by", " ", "Pedro", " ", 
     RowBox[{
     "Faria", "**", "**", "**", "**", "**", "**", "**", "**", 
      "\[IndentingNewLine]", "Values"}], " ", "for", " ", "the", " ", 
     "physical", " ", "quantities", " ", "relevant", " ", "in", " ", "the", 
     " ", "experiment", " ", "performed", " ", "by", " ", "Hodgkin", " ", 
     "and", " ", "Huxley", " ", "with", " ", "the", " ", "squid", " ", 
     "giant", " ", 
     RowBox[{"axon", ".", " ", "Conductances"}], " ", "are", " ", "given", 
     " ", "in", " ", 
     FractionBox["mho", 
      SuperscriptBox["cm", "2"]]}], ",", " ", 
    RowBox[{"voltages", " ", "in", " ", "mV"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"GNa", "=", 
     RowBox[{"120.0", "\[Times]", 
      SuperscriptBox["10", 
       RowBox[{"-", "3"}]]}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"Sodium", " ", "Maximum", " ", "Conductance"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GK", "=", 
     RowBox[{"36", "\[Times]", 
      SuperscriptBox["10", 
       RowBox[{"-", "3"}]]}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"Potassium", " ", "Maximum", " ", "Conductance"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GL", "=", 
     RowBox[{"0.3", "\[Times]", 
      SuperscriptBox["10", 
       RowBox[{"-", "3"}]]}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"Leakage", " ", "Current", " ", "Maximum", " ", "Conductance"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"VNa", "=", "115"}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"Sodium", " ", "Diffusion", " ", "Potential"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"VK", "=", 
     RowBox[{"-", "12"}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"Potassium", " ", "Diffusion", " ", "Potential"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"VL", "=", "11"}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{"Leakage", " ", "Current", " ", "Diffusion", " ", "Potential"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"a", "=", 
     RowBox[{"238", "\[Times]", 
      SuperscriptBox["10", 
       RowBox[{"-", "4"}]]}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Radius", " ", "of", " ", "the", " ", "axon"}], ",", " ", 
     RowBox[{"given", " ", "in", " ", "cm"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Cap", "=", 
     SuperscriptBox["10", 
      RowBox[{"-", "3"}]]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Capacitance", " ", "per", " ", "unit", " ", "area", " ", "of", " ", 
      "the", " ", "axon", " ", "membrane"}], ",", " ", 
     RowBox[{"given", " ", "in", " ", 
      FractionBox["mF", 
       SuperscriptBox["cm", "2"]]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"r", "=", 
     RowBox[{"2", "\[Times]", 
      SuperscriptBox["10", "4"]}]}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Longitudinal", " ", "resistance", " ", "per", " ", "unit", " ", 
      "length", " ", "of", " ", "the", " ", "axon"}], ",", " ", 
     RowBox[{"given", " ", "in", " ", 
      FractionBox["ohm", "cm"]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"m0", "=", "0.053"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"h0", "=", "0.59"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"n0", "=", "0.318"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"V0", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Voltage", "-", 
      RowBox[{
      "dependent", " ", "coefficients", " ", "to", " ", "be", " ", "used", 
       " ", "in", " ", "the", " ", "equations", " ", "for", " ", "the", " ", 
       "dynamics", " ", "of", " ", "gate"}], "-", 
      RowBox[{"variables", " ", "m"}]}], ",", 
     RowBox[{"h", " ", "and", " ", "n"}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"am", "[", "V_", "]"}], ":=", 
     FractionBox[
      RowBox[{"0.1", 
       RowBox[{"(", 
        RowBox[{"25", "-", "V"}], ")"}]}], 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"25", "-", "V"}], "10"]], "-", "1"}]]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bm", "[", "V_", "]"}], ":=", 
     RowBox[{"4", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", 
        FractionBox["V", "18"]}]]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ah", "[", "V_", "]"}], ":=", 
     RowBox[{"0.07", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", 
        FractionBox["V", "20"]}]]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bh", "[", "V_", "]"}], ":=", 
     FractionBox["1", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"30", "-", "V"}], "10"]], "+", "1"}]]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"an", "[", "V_", "]"}], ":=", 
     FractionBox[
      RowBox[{"0.01", 
       RowBox[{"(", 
        RowBox[{"10", "-", "V"}], ")"}]}], 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"10", "-", "V"}], "10"]], "-", "1"}]]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"bn", "[", "V_", "]"}], ":=", 
     RowBox[{"0.125", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"-", 
        FractionBox["V", "80"]}]]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
      "Equations", " ", "for", " ", "the", " ", "dynamics", " ", "of", " ", 
       "gate"}], "-", 
      RowBox[{"variables", " ", "m"}]}], ",", 
     RowBox[{"h", " ", "and", " ", 
      RowBox[{"n", ".", " ", "dm"}]}], ",", " ", 
     RowBox[{"dh", " ", "and", " ", "dn", " ", "stand", " ", "for", " ", 
      FractionBox["dm", "dt"]}], ",", " ", 
     RowBox[{
      FractionBox["dh", "dt"], " ", "and", " ", 
      FractionBox["dn", "dt"]}], ",", " ", "respectively"}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dm", "[", "t_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"am", "[", 
        RowBox[{"V", "[", "t", "]"}], "]"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"m", "[", "t", "]"}]}], ")"}]}], "-", 
      RowBox[{
       RowBox[{"bm", "[", 
        RowBox[{"V", "[", "t", "]"}], "]"}], 
       RowBox[{"m", "[", "t", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dh", "[", "t_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"ah", "[", 
        RowBox[{"V", "[", "t", "]"}], "]"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"h", "[", "t", "]"}]}], ")"}]}], "-", 
      RowBox[{
       RowBox[{"bh", "[", 
        RowBox[{"V", "[", "t", "]"}], "]"}], 
       RowBox[{"h", "[", "t", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dn", "[", "t_", "]"}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{"an", "[", 
        RowBox[{"V", "[", "t", "]"}], "]"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"n", "[", "t", "]"}]}], ")"}]}], "-", 
      RowBox[{
       RowBox[{"bn", "[", 
        RowBox[{"V", "[", "t", "]"}], "]"}], 
       RowBox[{"n", "[", "t", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Aperture", " ", "of", " ", "the", " ", "sodium", " ", "and", " ", 
     "potassium", " ", "channels"}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ChannelsNa", "[", "u_", "]"}], ":=", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"m", "[", "u", "]"}], ")"}], "3"], 
      RowBox[{"h", "[", "u", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ChannelsK", "[", "u_", "]"}], ":=", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"n", "[", "u", "]"}], ")"}], "4"]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Current", " ", "density", " ", "of", " ", "sodium"}], ",", " ", 
     RowBox[{"potassium", " ", "and", " ", "leakage", " ", "current"}], ",", 
     " ", 
     RowBox[{
     "together", " ", "with", " ", "the", " ", "resultant", " ", "ion", " ", 
      "current", " ", "density"}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"JNa", "[", "u_", "]"}], ":=", 
     RowBox[{"GNa", " ", 
      RowBox[{"ChannelsNa", "[", "u", "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"V", "[", "u", "]"}], "-", "VNa"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"JK", "[", "u_", "]"}], ":=", 
     RowBox[{"GK", " ", 
      RowBox[{"ChannelsK", "[", "u", "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"V", "[", "u", "]"}], "-", "VK"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"JL", "[", "u_", "]"}], ":=", 
     RowBox[{"GL", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"V", "[", "u", "]"}], "-", "VL"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Jion", "[", "u_", "]"}], ":=", 
     RowBox[{
      RowBox[{"JNa", "[", "u", "]"}], "+", 
      RowBox[{"JK", "[", "u", "]"}], "+", 
      RowBox[{"JL", "[", "u", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Auxiliary", " ", "function", " ", "whose", " ", "role", " ", "is", " ", 
      "to", " ", "provide", " ", "the", " ", "right", " ", "information", " ",
       "to", " ", "the", " ", "Plot", " ", "command"}], ",", " ", 
     RowBox[{
     "in", " ", "order", " ", "to", " ", "create", " ", "the", " ", "plot", 
      " ", "according", " ", "to", " ", "the", " ", "user", " ", 
      "specifications"}], ",", " ", "namely", ",", " ", 
     RowBox[{"inserting", " ", "only", " ", "the", " ", "requested", " ", 
      RowBox[{"curves", ".", " ", "Notice"}], " ", "that", " ", "current", 
      " ", "and", " ", "gate", " ", "variables", " ", "appear", " ", 
      "multiplied", " ", "by", " ", "a", " ", "factor", " ", "of", " ", "100",
       " ", "so", " ", "they", " ", "show", " ", "up", " ", "on", " ", "the", 
      " ", "plot", " ", "with", " ", "a", " ", "size", " ", "that", " ", 
      "allows", " ", "them", " ", "to", " ", "be", " ", "compared", " ", "to",
       " ", "the", " ", 
      RowBox[{"voltage", ".", " ", "This"}], " ", "scaling", " ", "is", " ", 
      "accounted", " ", "for", " ", "in", " ", "the", " ", "units", " ", 
      "shown", " ", "on", " ", "the", " ", "plot", " ", "axis"}]}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"curveInfo", "=", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "Voltage", ",", "Current", ",", "NaCurrent", ",", "KCurrent", ",", 
         "NaOpen", ",", "KOpen"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"curves", ",", "info"}], "}"}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"curves", "=", 
           RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"info", "=", 
           RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{"Voltage", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"curves", "=", 
              RowBox[{"Append", "[", 
               RowBox[{"curves", ",", 
                RowBox[{"V", "[", "t", "]"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"info", "=", 
              RowBox[{"Append", "[", 
               RowBox[{"info", ",", "Blue"}], "]"}]}]}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{"Current", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"curves", "=", 
              RowBox[{"Append", "[", 
               RowBox[{"curves", ",", 
                RowBox[{
                 RowBox[{"-", "100"}], 
                 RowBox[{"Jion", "[", "t", "]"}]}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"info", "=", 
              RowBox[{"Append", "[", 
               RowBox[{"info", ",", "Black"}], "]"}]}]}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{"NaCurrent", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"curves", "=", 
              RowBox[{"Append", "[", 
               RowBox[{"curves", ",", 
                RowBox[{
                 RowBox[{"-", "100"}], 
                 RowBox[{"JNa", "[", "t", "]"}]}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"info", "=", 
              RowBox[{"Append", "[", 
               RowBox[{"info", ",", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Red", ",", "Dashed"}], "]"}]}], "]"}]}]}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{"KCurrent", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"curves", "=", 
              RowBox[{"Append", "[", 
               RowBox[{"curves", ",", 
                RowBox[{
                 RowBox[{"-", "100"}], 
                 RowBox[{"JK", "[", "t", "]"}]}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"info", "=", 
              RowBox[{"Append", "[", 
               RowBox[{"info", ",", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Brown", ",", "Dashed"}], "]"}]}], "]"}]}]}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{"NaOpen", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"curves", "=", 
              RowBox[{"Append", "[", 
               RowBox[{"curves", ",", 
                RowBox[{"100", 
                 RowBox[{"ChannelsNa", "[", "t", "]"}]}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"info", "=", 
              RowBox[{"Append", "[", 
               RowBox[{"info", ",", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Red", ",", "Thick"}], "]"}]}], "]"}]}]}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{"KOpen", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"curves", "=", 
              RowBox[{"Append", "[", 
               RowBox[{"curves", ",", 
                RowBox[{"100", 
                 RowBox[{"ChannelsK", "[", "t", "]"}]}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"info", "=", 
              RowBox[{"Append", "[", 
               RowBox[{"info", ",", 
                RowBox[{"Directive", "[", 
                 RowBox[{"Brown", ",", "Thick"}], "]"}]}], "]"}]}]}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"curves", ",", "info"}], "}"}]}]}], "\[IndentingNewLine]", 
        "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"UPS", " ", "stands", " ", 
      RowBox[{"for", " ", "'"}], "Unique", " ", "Point", " ", 
      RowBox[{"Solution", "'"}]}], ",", " ", 
     RowBox[{
     "since", " ", "it", " ", "finds", " ", "and", " ", "plots", " ", "a", 
      " ", "numerical", " ", "solution", " ", "for", " ", "the", " ", 
      "behaviour", " ", "of", " ", "voltage"}], ",", " ", 
     RowBox[{
     "currents", " ", "and", " ", "gates", " ", "in", " ", "a", " ", "chosen",
       " ", "point", " ", "along", " ", "the", " ", 
      RowBox[{"axon", ".", " ", "J0"}], " ", "is", " ", "the", " ", 
      "stimulus", " ", "current"}], ",", 
     RowBox[{"dV", " ", "is", " ", "the", " ", "function", " ", 
      FractionBox["dV", "dt"], " ", "and", " ", "s", " ", "is", " ", "the", 
      " ", "numerical", " ", "solution", " ", "returned", " ", "by", " ", 
      "the", " ", "Mathematica", " ", "function", " ", "NDSolve"}]}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"UPS", "=", 
     RowBox[{"Function", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "stimulus", ",", " ", "start", ",", "duration", ",", "m0", ",", "h0", 
         ",", "n0", ",", "V0", ",", "domaini", ",", "domainf", ",", "rangel", 
         ",", "rangeh", ",", "Voltage", ",", "Current", ",", "NaCurrent", ",",
          "KCurrent", ",", "NaOpen", ",", "KOpen", ",", "Scenario"}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"J0", ",", "dV", ",", "s"}], "}"}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"J0", "=", 
           RowBox[{"Function", "[", 
            RowBox[{"t", ",", "\[IndentingNewLine]", 
             RowBox[{"If", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
               "start", "\[LessEqual]", "t", "\[LessEqual]", "duration"}], 
               ",", "\[IndentingNewLine]", "stimulus", ",", 
               "\[IndentingNewLine]", "0"}], "\[IndentingNewLine]", "]"}]}], 
            "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"dV", "=", 
           RowBox[{"Function", "[", 
            RowBox[{"t", ",", "\[IndentingNewLine]", 
             FractionBox[
              RowBox[{
               RowBox[{"J0", "[", "t", "]"}], "-", 
               RowBox[{"Jion", "[", "t", "]"}]}], "Cap"]}], 
            "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"s", "=", 
           RowBox[{"NDSolve", "[", 
            RowBox[{
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"V", "'"}], "[", "t", "]"}], "\[Equal]", 
                RowBox[{"dV", "[", "t", "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"m", "'"}], "[", "t", "]"}], "==", 
                RowBox[{"dm", "[", "t", "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"h", "'"}], "[", "t", "]"}], "==", 
                RowBox[{"dh", "[", "t", "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"n", "'"}], "[", "t", "]"}], "==", 
                RowBox[{"dn", "[", "t", "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"V", "[", "0", "]"}], "==", "V0"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"m", "[", "0", "]"}], "==", "m0"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"h", "[", "0", "]"}], "==", "h0"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"n", "[", "0", "]"}], "==", "n0"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"V", ",", "m", ",", "h", ",", "n"}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"t", ",", "domainf"}], "}"}]}], "\[IndentingNewLine]", 
            "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"plottingInfo", "=", 
           RowBox[{"curveInfo", "[", 
            RowBox[{
            "Voltage", ",", "Current", ",", "NaCurrent", ",", "KCurrent", ",",
              "NaOpen", ",", "KOpen"}], "]"}]}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"Plot", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Evaluate", "[", 
             RowBox[{
              RowBox[{"plottingInfo", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "/.", "s"}], "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"t", ",", "domaini", ",", "domainf"}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"PlotRange", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"rangel", ",", "rangeh"}], "}"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"AxesLabel", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
              "\"\<time (ms)\>\"", ",", 
               "\"\<membrane voltage (mV) \\n current density \
(10\[Mu]A/\!\(\*SuperscriptBox[\(cm\), \(2\)]\))\>\""}], "}"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"AxesOrigin", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"domaini", ",", "rangel"}], "}"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"GridLinesStyle", "\[Rule]", "Dashed"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"ImageSize", "\[Rule]", "450"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"PlotStyle", "->", 
             RowBox[{"plottingInfo", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.7214036249494133`*^9, 3.721403653654419*^9}, 
   3.7214084034570675`*^9, {3.721452291069277*^9, 3.721452309838225*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Manipulate", " ", "command"}], ",", " ", 
    RowBox[{
    "responsible", " ", "for", " ", "creating", " ", "the", " ", "interface", 
     " ", "pane"}]}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"UPS", "[", 
     RowBox[{
     "Stimulus", ",", "Start", ",", "Duration", ",", "m0", ",", "h0", ",", 
      "n0", ",", "V0", ",", "domaini", ",", "domainf", ",", "rangel", ",", 
      "rangeh", ",", "Voltage", ",", "Current", ",", "NaCurrent", ",", 
      "KCurrent", ",", "NaOpen", ",", "KOpen", ",", "Scenario"}], "]"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "Stimulus", ",", "0.02", ",", " ", 
        "\"\<stimulus strength (mA/\!\(\*SuperscriptBox[\(cm\), \
\(2\)]\))\>\""}], "}"}], ",", "0", ",", "0.5", ",", 
      RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
      RowBox[{"ControlPlacement", "\[Rule]", "Top"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Start", ",", "10", ",", "\"\<start of stimulus (ms)\>\""}], 
       "}"}], ",", "0", ",", "100", ",", 
      RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
      RowBox[{"ControlPlacement", "\[Rule]", "Top"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Duration", ",", "40", ",", "\"\<stimulus duration (ms)\>\""}],
        "}"}], ",", "0", ",", "100", ",", 
      RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
      RowBox[{"ControlPlacement", "\[Rule]", "Top"}]}], "}"}], ",", 
    "\[IndentingNewLine]", "Delimiter", ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"domaini", ",", "0", ",", "\"\<initial time\>\""}], "}"}], ",",
       "0", ",", 
      RowBox[{"domainf", "-", "0.0000000001"}], ",", 
      RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
      RowBox[{"ControlPlacement", "\[Rule]", "Top"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"domainf", ",", "50", ",", "\"\<final time\>\""}], "}"}], ",", 
      RowBox[{"domaini", "+", "0.0000000001"}], ",", "100", ",", 
      RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
      RowBox[{"ControlPlacement", "\[Rule]", "Top"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"rangel", ",", 
        RowBox[{"-", "20"}], ",", "\"\<minimum range\>\""}], "}"}], ",", 
      RowBox[{"-", "120"}], ",", 
      RowBox[{"rangeh", "-", "0.0000000001"}], ",", 
      RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
      RowBox[{"ControlPlacement", "\[Rule]", "Top"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"rangeh", ",", "120", ",", "\"\<maximum range\>\""}], "}"}], 
      ",", 
      RowBox[{"rangel", "+", "0.0000000001"}], ",", "120", ",", 
      RowBox[{"Appearance", "\[Rule]", "\"\<Labeled\>\""}], ",", 
      RowBox[{"ControlPlacement", "\[Rule]", "Top"}]}], "}"}], ",", 
    "\[IndentingNewLine]", "Delimiter", ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Voltage", ",", "True", ",", 
        RowBox[{"Style", "[", 
         RowBox[{"\"\<membrane voltage\>\"", ",", "Blue"}], "]"}]}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"True", ",", "False"}], "}"}], ",", 
      RowBox[{"ControlPlacement", "\[Rule]", "Left"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Current", ",", "False", ",", 
        RowBox[{"Style", "[", 
         RowBox[{"\"\<ion current\>\"", ",", "Black"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"True", ",", "False"}], "}"}], ",", 
      RowBox[{"ControlPlacement", "\[Rule]", "Left"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"NaCurrent", ",", "False", ",", 
        RowBox[{"Style", "[", 
         RowBox[{
         "\"\<\!\(\*SuperscriptBox[\(Na\), \(+\)]\) current\>\"", ",", 
          "Red"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"True", ",", "False"}], "}"}], ",", 
      RowBox[{"ControlPlacement", "\[Rule]", "Left"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"KCurrent", ",", "False", ",", 
        RowBox[{"Style", "[", 
         RowBox[{
         "\"\<\!\(\*SuperscriptBox[\(K\), \(+\)]\) current\>\"", ",", 
          "Brown"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"True", ",", "False"}], "}"}], ",", 
      RowBox[{"ControlPlacement", "\[Rule]", "Left"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"NaOpen", ",", "False", ",", 
        RowBox[{"Style", "[", 
         RowBox[{
         "\"\<(\!\(\*SuperscriptBox[\(Na\), \(+\)]\) channels aperture)\>\"", 
          ",", "Bold", ",", "Red"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"True", ",", "False"}], "}"}], ",", 
      RowBox[{"ControlPlacement", "\[Rule]", "Left"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"KOpen", ",", "False", ",", 
        RowBox[{"Style", "[", 
         RowBox[{
         "\"\<(\!\(\*SuperscriptBox[\(K\), \(+\)]\) channels aperture)\>\"", 
          ",", "Bold", ",", "Brown"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"True", ",", "False"}], "}"}], ",", 
      RowBox[{"ControlPlacement", "\[Rule]", "Left"}]}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"SaveDefinitions", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input"],

Cell[BoxData[
 TemplateBox[{
  "Duration$$","shdw",
   "\"Symbol \\!\\(\\*RowBox[{\\\"\\\\\\\"Duration$$\\\\\\\"\\\"}]\\) appears \
in multiple contexts \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"\\\\\\\"System`\\\\\\\"\\\", \\\",\\\", \\\"\\\\\\\"Global`\\\\\\\
\"\\\"}], \\\"}\\\"}]\\); definitions in context \
\\!\\(\\*RowBox[{\\\"\\\\\\\"System`\\\\\\\"\\\"}]\\) may shadow or be \
shadowed by other definitions.\"",2,48,1,28700902521840521756,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7214750723014297`*^9}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`Current$$ = True, $CellContext`domainf$$ = 
    50, $CellContext`domaini$$ = 0., Duration$$ = 
    40, $CellContext`KCurrent$$ = True, $CellContext`KOpen$$ = 
    True, $CellContext`NaCurrent$$ = True, $CellContext`NaOpen$$ = 
    True, $CellContext`rangeh$$ = 
    120, $CellContext`rangel$$ = -20, $CellContext`Start$$ = 
    10, $CellContext`Stimulus$$ = 0.25, $CellContext`Voltage$$ = True, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`Stimulus$$], 0.02, 
       "stimulus strength (mA/\!\(\*SuperscriptBox[\(cm\), \(2\)]\))"}, 0, 
      0.5}, {{
       Hold[$CellContext`Start$$], 10, "start of stimulus (ms)"}, 0, 100}, {{
       Hold[Duration$$], 40, "stimulus duration (ms)"}, 0, 100}, {{
       Hold[$CellContext`domaini$$], 0, "initial time"}, 0, 
      Dynamic[$CellContext`domainf$$ - 1.*^-10]}, {{
       Hold[$CellContext`domainf$$], 50, "final time"}, 
      Dynamic[$CellContext`domaini$$ + 1.*^-10], 100}, {{
       Hold[$CellContext`rangel$$], -20, "minimum range"}, -120, 
      Dynamic[$CellContext`rangeh$$ - 1.*^-10]}, {{
       Hold[$CellContext`rangeh$$], 120, "maximum range"}, 
      Dynamic[$CellContext`rangel$$ + 1.*^-10], 120}, {{
       Hold[$CellContext`Voltage$$], True, 
       Style["membrane voltage", 
        RGBColor[0, 0, 1]]}, {True, False}}, {{
       Hold[$CellContext`Current$$], False, 
       Style["ion current", 
        GrayLevel[0]]}, {True, False}}, {{
       Hold[$CellContext`NaCurrent$$], False, 
       Style["\!\(\*SuperscriptBox[\(Na\), \(+\)]\) current", 
        RGBColor[1, 0, 0]]}, {True, False}}, {{
       Hold[$CellContext`KCurrent$$], False, 
       Style["\!\(\*SuperscriptBox[\(K\), \(+\)]\) current", 
        RGBColor[0.6, 0.4, 0.2]]}, {True, False}}, {{
       Hold[$CellContext`NaOpen$$], False, 
       Style[
       "(\!\(\*SuperscriptBox[\(Na\), \(+\)]\) channels aperture)", Bold, 
        RGBColor[1, 0, 0]]}, {True, False}}, {{
       Hold[$CellContext`KOpen$$], False, 
       Style["(\!\(\*SuperscriptBox[\(K\), \(+\)]\) channels aperture)", Bold, 
        RGBColor[0.6, 0.4, 0.2]]}, {True, False}}}, Typeset`size$$ = {
    450., {131., 136.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = False, $CellContext`Stimulus$10199$$ = 
    0, $CellContext`Start$10200$$ = 0, Duration$10201$$ = 
    0, $CellContext`domaini$10202$$ = 0, $CellContext`domainf$10203$$ = 
    0, $CellContext`rangel$10204$$ = 0, $CellContext`rangeh$10205$$ = 
    0, $CellContext`Voltage$10206$$ = False, $CellContext`Current$10207$$ = 
    False, $CellContext`NaCurrent$10208$$ = 
    False, $CellContext`KCurrent$10209$$ = 
    False, $CellContext`NaOpen$10210$$ = False, $CellContext`KOpen$10211$$ = 
    False}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`Current$$ = False, $CellContext`domainf$$ = 
        50, $CellContext`domaini$$ = 0, Duration$$ = 
        40, $CellContext`KCurrent$$ = False, $CellContext`KOpen$$ = 
        False, $CellContext`NaCurrent$$ = False, $CellContext`NaOpen$$ = 
        False, $CellContext`rangeh$$ = 
        120, $CellContext`rangel$$ = -20, $CellContext`Start$$ = 
        10, $CellContext`Stimulus$$ = 0.02, $CellContext`Voltage$$ = True}, 
      "ControllerVariables" :> {
        Hold[$CellContext`Stimulus$$, $CellContext`Stimulus$10199$$, 0], 
        Hold[$CellContext`Start$$, $CellContext`Start$10200$$, 0], 
        Hold[Duration$$, Duration$10201$$, 0], 
        Hold[$CellContext`domaini$$, $CellContext`domaini$10202$$, 0], 
        Hold[$CellContext`domainf$$, $CellContext`domainf$10203$$, 0], 
        Hold[$CellContext`rangel$$, $CellContext`rangel$10204$$, 0], 
        Hold[$CellContext`rangeh$$, $CellContext`rangeh$10205$$, 0], 
        Hold[$CellContext`Voltage$$, $CellContext`Voltage$10206$$, False], 
        Hold[$CellContext`Current$$, $CellContext`Current$10207$$, False], 
        Hold[$CellContext`NaCurrent$$, $CellContext`NaCurrent$10208$$, False], 
        Hold[$CellContext`KCurrent$$, $CellContext`KCurrent$10209$$, False], 
        Hold[$CellContext`NaOpen$$, $CellContext`NaOpen$10210$$, False], 
        Hold[$CellContext`KOpen$$, $CellContext`KOpen$10211$$, False]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> $CellContext`UPS[$CellContext`Stimulus$$, \
$CellContext`Start$$, 
        Duration$$, $CellContext`m0, $CellContext`h0, $CellContext`n0, \
$CellContext`V0, $CellContext`domaini$$, $CellContext`domainf$$, \
$CellContext`rangel$$, $CellContext`rangeh$$, $CellContext`Voltage$$, \
$CellContext`Current$$, $CellContext`NaCurrent$$, $CellContext`KCurrent$$, \
$CellContext`NaOpen$$, $CellContext`KOpen$$, $CellContext`Scenario], 
      "Specifications" :> {{{$CellContext`Stimulus$$, 0.02, 
          "stimulus strength (mA/\!\(\*SuperscriptBox[\(cm\), \(2\)]\))"}, 0, 
         0.5, Appearance -> "Labeled", ControlPlacement -> 
         Top}, {{$CellContext`Start$$, 10, "start of stimulus (ms)"}, 0, 100, 
         Appearance -> "Labeled", ControlPlacement -> Top}, {{
         Duration$$, 40, "stimulus duration (ms)"}, 0, 100, Appearance -> 
         "Labeled", ControlPlacement -> Top}, 
        Delimiter, {{$CellContext`domaini$$, 0, "initial time"}, 0, 
         Dynamic[$CellContext`domainf$$ - 1.*^-10], Appearance -> "Labeled", 
         ControlPlacement -> 
         Top}, {{$CellContext`domainf$$, 50, "final time"}, 
         Dynamic[$CellContext`domaini$$ + 1.*^-10], 100, Appearance -> 
         "Labeled", ControlPlacement -> 
         Top}, {{$CellContext`rangel$$, -20, "minimum range"}, -120, 
         Dynamic[$CellContext`rangeh$$ - 1.*^-10], Appearance -> "Labeled", 
         ControlPlacement -> 
         Top}, {{$CellContext`rangeh$$, 120, "maximum range"}, 
         Dynamic[$CellContext`rangel$$ + 1.*^-10], 120, Appearance -> 
         "Labeled", ControlPlacement -> Top}, 
        Delimiter, {{$CellContext`Voltage$$, True, 
          Style["membrane voltage", 
           RGBColor[0, 0, 1]]}, {True, False}, ControlPlacement -> 
         Left}, {{$CellContext`Current$$, False, 
          Style["ion current", 
           GrayLevel[0]]}, {True, False}, ControlPlacement -> 
         Left}, {{$CellContext`NaCurrent$$, False, 
          Style["\!\(\*SuperscriptBox[\(Na\), \(+\)]\) current", 
           RGBColor[1, 0, 0]]}, {True, False}, ControlPlacement -> 
         Left}, {{$CellContext`KCurrent$$, False, 
          Style["\!\(\*SuperscriptBox[\(K\), \(+\)]\) current", 
           RGBColor[0.6, 0.4, 0.2]]}, {True, False}, ControlPlacement -> 
         Left}, {{$CellContext`NaOpen$$, False, 
          Style[
          "(\!\(\*SuperscriptBox[\(Na\), \(+\)]\) channels aperture)", Bold, 
           RGBColor[1, 0, 0]]}, {True, False}, ControlPlacement -> 
         Left}, {{$CellContext`KOpen$$, False, 
          Style[
          "(\!\(\*SuperscriptBox[\(K\), \(+\)]\) channels aperture)", Bold, 
           RGBColor[0.6, 0.4, 0.2]]}, {True, False}, ControlPlacement -> 
         Left}}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{649., {277., 283.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    Initialization:>({$CellContext`UPS = 
       Function[{$CellContext`stimulus, $CellContext`start, \
$CellContext`duration, $CellContext`m0, $CellContext`h0, $CellContext`n0, \
$CellContext`V0, $CellContext`domaini, $CellContext`domainf, \
$CellContext`rangel, $CellContext`rangeh, $CellContext`Voltage, \
$CellContext`Current, $CellContext`NaCurrent, $CellContext`KCurrent, \
$CellContext`NaOpen, $CellContext`KOpen, $CellContext`Scenario}, 
         Block[{$CellContext`J0, $CellContext`dV, $CellContext`s}, \
$CellContext`J0 = Function[$CellContext`t, 
             
             If[$CellContext`start <= $CellContext`t <= \
$CellContext`duration, $CellContext`stimulus, 0]]; $CellContext`dV = 
           Function[$CellContext`t, ($CellContext`J0[$CellContext`t] - \
$CellContext`Jion[$CellContext`t])/Cap]; $CellContext`s = 
           NDSolve[{
             Derivative[
               1][$CellContext`V][$CellContext`t] == \
$CellContext`dV[$CellContext`t], 
              Derivative[
               1][$CellContext`m][$CellContext`t] == \
$CellContext`dm[$CellContext`t], 
              Derivative[
               1][$CellContext`h][$CellContext`t] == \
$CellContext`dh[$CellContext`t], 
              Derivative[
               1][$CellContext`n][$CellContext`t] == \
$CellContext`dn[$CellContext`t], $CellContext`V[
               0] == $CellContext`V0, $CellContext`m[
               0] == $CellContext`m0, $CellContext`h[
               0] == $CellContext`h0, $CellContext`n[
               0] == $CellContext`n0}, {$CellContext`V, $CellContext`m, \
$CellContext`h, $CellContext`n}, {$CellContext`t, $CellContext`domainf}]; \
$CellContext`plottingInfo = $CellContext`curveInfo[$CellContext`Voltage, \
$CellContext`Current, $CellContext`NaCurrent, $CellContext`KCurrent, \
$CellContext`NaOpen, $CellContext`KOpen]; Plot[
            Evaluate[
             ReplaceAll[
              
              Part[$CellContext`plottingInfo, 
               1], $CellContext`s]], {$CellContext`t, $CellContext`domaini, \
$CellContext`domainf}, 
            PlotRange -> {$CellContext`rangel, $CellContext`rangeh}, 
            AxesLabel -> {
             "time (ms)", 
              "membrane voltage (mV) \n current density \
(10\[Mu]A/\!\(\*SuperscriptBox[\(cm\), \(2\)]\))"}, 
            AxesOrigin -> {$CellContext`domaini, $CellContext`rangel}, 
            GridLines -> Automatic, GridLinesStyle -> Dashed, ImageSize -> 
            450, PlotStyle -> 
            Part[$CellContext`plottingInfo, 2]]]], $CellContext`m0 = 
       0.053, $CellContext`h0 = 0.59, $CellContext`n0 = 
       0.318, $CellContext`V0 = 0, $CellContext`dV = 
       Function[$CellContext`t, ($CellContext`I0[$CellContext`t] - \
$CellContext`Itot[$CellContext`t])/Cap], $CellContext`I0 = 
       Function[$CellContext`t, 
         If[$CellContext`start <= $CellContext`t <= $CellContext`duration, \
$CellContext`stimulus, 0]], $CellContext`Itot[
         Pattern[$CellContext`u, 
          
          Blank[]]] := $CellContext`INa[$CellContext`u] + \
$CellContext`IK[$CellContext`u] + $CellContext`IL[$CellContext`u], \
$CellContext`INa[
         Pattern[$CellContext`u, 
          
          Blank[]]] := $CellContext`gNa $CellContext`aNa \
($CellContext`V[$CellContext`u] - $CellContext`VNa), $CellContext`aNa[
         Pattern[$CellContext`u, 
          
          Blank[]]] := $CellContext`m[$CellContext`u] $CellContext`\.b3 \
$CellContext`h[$CellContext`u], $CellContext`VNa = 115, $CellContext`IK[
         Pattern[$CellContext`u, 
          
          Blank[]]] := $CellContext`gK $CellContext`aK \
($CellContext`V[$CellContext`u] - $CellContext`VK), $CellContext`aK[
         Pattern[$CellContext`u, 
          
          Blank[]]] := $CellContext`n[$CellContext`u]^4, $CellContext`VK = \
-12, $CellContext`IL[
         Pattern[$CellContext`u, 
          
          Blank[]]] := $CellContext`gL ($CellContext`V[$CellContext`u] - \
$CellContext`VL), $CellContext`VL = 11, Cap = 1/1000, $CellContext`Jion[
         Pattern[$CellContext`u, 
          
          Blank[]]] := $CellContext`JNa[$CellContext`u] + \
$CellContext`JK[$CellContext`u] + $CellContext`JL[$CellContext`u], \
$CellContext`JNa[
         Pattern[$CellContext`u, 
          
          Blank[]]] := $CellContext`GNa \
$CellContext`ChannelsNa[$CellContext`u] ($CellContext`V[$CellContext`u] - \
$CellContext`VNa), $CellContext`GNa = 0.12, $CellContext`ChannelsNa[
         Pattern[$CellContext`u, 
          
          Blank[]]] := $CellContext`m[$CellContext`u]^3 \
$CellContext`h[$CellContext`u], $CellContext`JK[
         Pattern[$CellContext`u, 
          
          Blank[]]] := $CellContext`GK $CellContext`ChannelsK[$CellContext`u] \
($CellContext`V[$CellContext`u] - $CellContext`VK), $CellContext`GK = 
       9/250, $CellContext`ChannelsK[
         Pattern[$CellContext`u, 
          Blank[]]] := $CellContext`n[$CellContext`u]^4, $CellContext`JL[
         Pattern[$CellContext`u, 
          
          Blank[]]] := $CellContext`GL ($CellContext`V[$CellContext`u] - \
$CellContext`VL), $CellContext`GL = 0.0003, 
       Attributes[Derivative] = {NHoldAll, ReadProtected}, $CellContext`dm[
         Pattern[$CellContext`t, 
          Blank[]]] := $CellContext`am[
           $CellContext`V[$CellContext`t]] (
          1 - $CellContext`m[$CellContext`t]) - $CellContext`bm[
          $CellContext`V[$CellContext`t]] $CellContext`m[$CellContext`t], \
$CellContext`am[
         Pattern[$CellContext`V, 
          Blank[]]] := (0.1 (25 - $CellContext`V))/(
        E^((25 - $CellContext`V)/10) - 1), $CellContext`bm[
         Pattern[$CellContext`V, 
          Blank[]]] := 4/E^($CellContext`V/18), $CellContext`dh[
         Pattern[$CellContext`t, 
          Blank[]]] := $CellContext`ah[
           $CellContext`V[$CellContext`t]] (
          1 - $CellContext`h[$CellContext`t]) - $CellContext`bh[
          $CellContext`V[$CellContext`t]] $CellContext`h[$CellContext`t], \
$CellContext`ah[
         Pattern[$CellContext`V, 
          Blank[]]] := 0.07/E^($CellContext`V/20), $CellContext`bh[
         Pattern[$CellContext`V, 
          Blank[]]] := 1/(E^((30 - $CellContext`V)/10) + 1), $CellContext`dn[
         Pattern[$CellContext`t, 
          Blank[]]] := $CellContext`an[
           $CellContext`V[$CellContext`t]] (
          1 - $CellContext`n[$CellContext`t]) - $CellContext`bn[
          $CellContext`V[$CellContext`t]] $CellContext`n[$CellContext`t], \
$CellContext`an[
         Pattern[$CellContext`V, 
          Blank[]]] := (0.01 (10 - $CellContext`V))/(
        E^((10 - $CellContext`V)/10) - 1), $CellContext`bn[
         Pattern[$CellContext`V, 
          Blank[]]] := 
       0.125/E^($CellContext`V/80), $CellContext`plottingInfo = {{
          $CellContext`V[$CellContext`t]}, {
          RGBColor[0, 0, 1]}}, $CellContext`curveInfo = 
       Function[{$CellContext`Voltage, $CellContext`Current, \
$CellContext`NaCurrent, $CellContext`KCurrent, $CellContext`NaOpen, \
$CellContext`KOpen}, 
         Block[{$CellContext`curves, $CellContext`info}, $CellContext`curves = \
{}; $CellContext`info = {}; 
          If[$CellContext`Voltage, $CellContext`curves = 
             Append[$CellContext`curves, 
               $CellContext`V[$CellContext`t]]; $CellContext`info = 
             Append[$CellContext`info, Blue]]; 
          If[$CellContext`Current, $CellContext`curves = 
             Append[$CellContext`curves, (-100) \
$CellContext`Jion[$CellContext`t]]; $CellContext`info = 
             Append[$CellContext`info, Black]]; 
          If[$CellContext`NaCurrent, $CellContext`curves = 
             Append[$CellContext`curves, (-100) \
$CellContext`JNa[$CellContext`t]]; $CellContext`info = 
             Append[$CellContext`info, 
               Directive[Red, Dashed]]]; 
          If[$CellContext`KCurrent, $CellContext`curves = 
             Append[$CellContext`curves, (-100) \
$CellContext`JK[$CellContext`t]]; $CellContext`info = 
             Append[$CellContext`info, 
               Directive[Brown, Dashed]]]; 
          If[$CellContext`NaOpen, $CellContext`curves = 
             Append[$CellContext`curves, 
               100 $CellContext`ChannelsNa[$CellContext`t]]; \
$CellContext`info = Append[$CellContext`info, 
               Directive[Red, Thick]]]; 
          If[$CellContext`KOpen, $CellContext`curves = 
             Append[$CellContext`curves, 
               100 $CellContext`ChannelsK[$CellContext`t]]; $CellContext`info = 
             Append[$CellContext`info, 
               Directive[
               Brown, Thick]]]; {$CellContext`curves, $CellContext`info}]], 
       Attributes[PlotRange] = {ReadProtected}}; Typeset`initDone$$ = True),
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.7214084207570815`*^9, 3.7214750723393955`*^9}]
}, Open  ]]
},
WindowSize->{1920, 997},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 23104, 574, 3281, "Input"],
Cell[CellGroupData[{
Cell[23687, 598, 6097, 151, 501, "Input"],
Cell[29787, 751, 542, 10, 23, "Message"],
Cell[30332, 763, 16647, 319, 577, "Output"]
}, Open  ]]
}
]
*)

